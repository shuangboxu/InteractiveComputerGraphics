第四次编程作业修改说明
==========================

本次修改基于上一次作业的代码，主要实现了光照效果（Blinn‑Phong 模型）和相关动画控制。以下是主要修改点：

1. **顶点结构与输入布局扩展**
   - 在 `GameApp.h` 中将 `VertexPosColor` 扩展为包含位置（pos）、法线（normal）和颜色（color）三个字段，并更新了输入布局 `inputLayout`，对应语义为 `POSITION`、`NORMAL`、`COLOR`。
   - 所有模型的顶点数据按照每个三角形拆分，计算面法线并赋值给每个顶点。`NameVertices.cpp` 中四个 case 均重新生成了顶点和索引；玩家立方体在 `GameApp.cpp` 中也按三角形计算了法线。

2. **光源和材质结构**
   - 在 `GameApp.h` 中新增了 `Light` 和 `Material` 结构，包含位置、方向、颜色、范围、聚光角、高光指数等参数，并在 `ConstantBuffer` 中加入三个光源数组、当前材质和观察者位置。
   - 新增成员变量 `m_ObjectMaterials` 保存四个汉字模型的材质属性，`m_Lights` 保存点光、聚光、方向光三盏灯，同时提供布尔开关控制其启用状态。

3. **光源初始化与动画**
   - 在 `InitResource` 中初始化材质和光源参数：方向光漫反射为柔和白光，点光源模拟萤火虫，聚光灯模拟手电筒并与相机绑定。
   - 在 `UpdateScene` 中根据时间更新点光源位置、颜色，实现萤火虫飞行动画；根据相机更新聚光灯的位置与方向；按下 `1`、`2`、`3` 键可以切换三盏灯的开关。

4. **常量缓冲区更新**
   - 在绘制每个对象（主字、子字、玩家立方体）前，更新常量缓冲区的世界矩阵、材质、光源数组和观察者位置。调用 `Map`/`Unmap` 将数据写入 GPU。

5. **HLSL 着色器重写**
   - 删除旧的 `Cube_VS.hlsl` 和 `Cube_PS.hlsl` 文件内容，重新编写顶点着色器与像素着色器。
   - 新的顶点着色器将顶点位置变换到世界/裁剪空间，并计算世界空间法线；像素着色器实现 Blinn‑Phong 光照模型，支持方向光、点光源和聚光灯，按光源类型和开关逐一累加环境光、漫反射和镜面反射分量。最后用顶点颜色调制结果。
   - 为确保运行时能够重新编译新的 HLSL 文件，删除了旧的预编译着色器文件 `Cube_VS.cso` 和 `Cube_PS.cso`。

6. **其他修改**
   - 在代码各处新增注释 `// 许双博第四次作业修改` 表示本次作业的修改位置，方便查阅。
   - 新增此修改说明文档，以便说明所有更改的目的与实现。

通过上述修改，程序可以在 Direct3D 11 环境下使用 Blinn‑Phong 模型正确渲染具有法线的彩色字符立方体森林，并支持点光、聚光和方向光的开关及动画效果。